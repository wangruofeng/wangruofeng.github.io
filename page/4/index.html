<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.wangruofeng007.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":"default","style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

        <meta name="description" content="王若风的技术博客">
<meta property="og:type" content="website">
<meta property="og:title" content="王若风的技术博客">
<meta property="og:url" content="https://blog.wangruofeng007.com/page/4/index.html">
<meta property="og:site_name" content="王若风的技术博客">
<meta property="og:description" content="王若风的技术博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="王若风">
<meta property="article:tag" content="技术博客, Flutter, iOS">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://blog.wangruofeng007.com/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

        <title>
            王若风的技术博客
        </title>
        
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-7M5CYEY807"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-7M5CYEY807');
      }
    </script>






        <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

    <link rel="alternate" href="/atom.xml" title="王若风的技术博客" type="application/atom+xml">
</head>

    <body itemscope="itemscope" itemtype="http://schema.org/WebPage">
        <div class="container use-motion">
            <div class="headband"></div>

            <header
                class="header"
                itemscope="itemscope"
                itemtype="http://schema.org/WPHeader">
                <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">王若风的技术博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">世界尽头の冷酷仙境</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
            </header>

            
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


            <main class="main">
                <div class="main-inner">
                    <div class="content-wrap">
                        

                        <div class="content index posts-expand">
                            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.wangruofeng007.com/2017/03/02/2017-03-02-vflshen-ru-qian-chu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="王若风">
      <meta itemprop="description" content="王若风的技术博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王若风的技术博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/03/02/2017-03-02-vflshen-ru-qian-chu/" class="post-title-link" itemprop="url">VFL 深入浅出</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-03-02 21:19:49" itemprop="dateCreated datePublished" datetime="2017-03-02T21:19:49+08:00">2017-03-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-03 13:32:35" itemprop="dateModified" datetime="2024-11-03T13:32:35+08:00">2024-11-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%B3%BB%E7%BB%9F-API/" itemprop="url" rel="index"><span itemprop="name">系统 API</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
  
    <a title="disqus" href="/2017/03/02/2017-03-02-vflshen-ru-qian-chu/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/03/02/2017-03-02-vflshen-ru-qian-chu/" itemprop="commentCount"></span>
    </a>
  </span>
  
 <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>839</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h3><p>给视图对象快速创建约束，可以使用比较冷门的 VFL(Visual Format Language),本质是是基于自动布局(AutoLayout)。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/03/02/2017-03-02-vflshen-ru-qian-chu/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.wangruofeng007.com/2017/02/23/2017-02-23-uiactivityviewcontroller-xiang-jie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="王若风">
      <meta itemprop="description" content="王若风的技术博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王若风的技术博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/02/23/2017-02-23-uiactivityviewcontroller-xiang-jie/" class="post-title-link" itemprop="url">UIActivity​View​Controller 详解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-02-23 23:23:12" itemprop="dateCreated datePublished" datetime="2017-02-23T23:23:12+08:00">2017-02-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-03 14:33:43" itemprop="dateModified" datetime="2024-11-03T14:33:43+08:00">2024-11-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%B3%BB%E7%BB%9F-API/" itemprop="url" rel="index"><span itemprop="name">系统 API</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
  
    <a title="disqus" href="/2017/02/23/2017-02-23-uiactivityviewcontroller-xiang-jie/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/02/23/2017-02-23-uiactivityviewcontroller-xiang-jie/" itemprop="commentCount"></span>
    </a>
  </span>
  
 <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>翻译自 NSHipster 的<a target="_blank" rel="noopener" href="http://nshipster.com/uiactivityviewcontroller/">UIActivity​View​Controller</a></p>
</blockquote>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/02/23/2017-02-23-uiactivityviewcontroller-xiang-jie/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.wangruofeng007.com/2017/01/09/2017-01-10-2016ge-ren-nian-du-zong-jie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="王若风">
      <meta itemprop="description" content="王若风的技术博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王若风的技术博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/01/09/2017-01-10-2016ge-ren-nian-du-zong-jie/" class="post-title-link" itemprop="url">2016 个人年度总结</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-01-09 23:48:07" itemprop="dateCreated datePublished" datetime="2017-01-09T23:48:07+08:00">2017-01-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-03 13:32:35" itemprop="dateModified" datetime="2024-11-03T13:32:35+08:00">2024-11-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%80%BB%E7%BB%93%E5%A4%8D%E7%9B%98/" itemprop="url" rel="index"><span itemprop="name">总结复盘</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
  
    <a title="disqus" href="/2017/01/09/2017-01-10-2016ge-ren-nian-du-zong-jie/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/01/09/2017-01-10-2016ge-ren-nian-du-zong-jie/" itemprop="commentCount"></span>
    </a>
  </span>
  
 <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>725</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>2016 对于我来说的意义，就像 10 年前的今天， <code>iPhone</code> 之余乔布斯， <code>iPhone</code> 发布后 10 年后的今天，小程序之余张小龙。它跨越了一道深深的鸿沟，并向自己理想的方向坚定前行。</p>
<p>一直相信努力就会有回报，付出就会有收获，是金子总会发光。</p>
<ul>
<li>2016 是我加入<a target="_blank" rel="noopener" href="https://www.klook.com/">客路</a>一周年的时间，认识了很多有趣的朋友和同事的一</li>
<li>2016 是我迈出自我，走出中国探索未知的世界的一年。</li>
<li>2016 是旅行，工作，生活，学习，社交一样都没落下的一年。</li>
</ul>
<p>曾经的铁哥们也即将回归东莞，这样我们的距离又进了一步，以后有更多的时间聊理想谈人生，想想突然好激动。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2017/01/09/2017-01-10-2016ge-ren-nian-du-zong-jie/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.wangruofeng007.com/2016/12/08/2016-12-08-shi-pin-bo-fang-tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="王若风">
      <meta itemprop="description" content="王若风的技术博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王若风的技术博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/12/08/2016-12-08-shi-pin-bo-fang-tips/" class="post-title-link" itemprop="url">视频播放 Tips</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-12-08 23:44:02" itemprop="dateCreated datePublished" datetime="2016-12-08T23:44:02+08:00">2016-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-03 14:35:03" itemprop="dateModified" datetime="2024-11-03T14:35:03+08:00">2024-11-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" itemprop="url" rel="index"><span itemprop="name">最佳实践</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
  
    <a title="disqus" href="/2016/12/08/2016-12-08-shi-pin-bo-fang-tips/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/12/08/2016-12-08-shi-pin-bo-fang-tips/" itemprop="commentCount"></span>
    </a>
  </span>
  
 <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>363</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="获取设备音量"><a href="#获取设备音量" class="headerlink" title="获取设备音量"></a>获取设备音量</h2><p>播放音频可以通过：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">MPMusicPlayerController</span> *iPod = [<span class="built_in">MPMusicPlayerController</span> systemMusicPlayer];</span><br><span class="line"><span class="type">float</span> volumeLevel = iPod.volume;</span><br></pre></td></tr></table></figure>

<p>播放视频可以通过：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float</span> outputVolume = [[<span class="built_in">AVAudioSession</span> sharedInstance] outputVolume];</span><br></pre></td></tr></table></figure>

<blockquote>
<p>推荐下面的方法，上面的在某些版本可能有问题，下面的方法兼容<strong>iOS6 及以上</strong>。</p>
</blockquote>
<h2 id="静音模式失效"><a href="#静音模式失效" class="headerlink" title="静音模式失效"></a>静音模式失效</h2><p>通过设置音频会话的 category 实现：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSError</span> *setCategoryError = <span class="literal">nil</span>;</span><br><span class="line"><span class="type">BOOL</span> success = [[<span class="built_in">AVAudioSession</span> sharedInstance] setCategory: <span class="built_in">AVAudioSessionCategoryPlayback</span></span><br><span class="line">	                                                  error: &amp;setCategoryError];</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> (!success) &#123; <span class="comment">/* handle the error in setCategoryError */</span> &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这样 App 就不会随着手机静音键打开而静音，可在手机静音下播放声音😁</p>
</blockquote>
<h2 id="监听音量改变"><a href="#监听音量改变" class="headerlink" title="监听音量改变"></a>监听音量改变</h2><p>监听音频改变私有通知：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(volumeChanged:) name:<span class="string">@&quot;AVSystemController_SystemVolumeDidChangeNotification&quot;</span> object:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>

<p>实现通过回调：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)volumeChanged:(<span class="built_in">NSNotification</span> *)notification</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">float</span> volume = [[[notification userInfo] objectForKey:<span class="string">@&quot;AVSystemController_AudioVolumeNotificationParameter&quot;</span>]</span><br><span class="line">     floatValue];</span><br><span class="line">     </span><br><span class="line">     <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="设置设备音量"><a href="#设置设备音量" class="headerlink" title="设置设备音量"></a>设置设备音量</h2><p>使用 <code>MPVolumeView</code> 类，便利它的子 views 找到类为 <code>MPVolumeSlider</code> 的滑竿。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">MPVolumeView</span> *volumeView = [[<span class="built_in">MPVolumeView</span> alloc] init];</span><br><span class="line"><span class="built_in">UISlider</span> *volumeViewSlider = <span class="literal">nil</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">UIView</span> *view <span class="keyword">in</span> [volumeView subviews])&#123;</span><br><span class="line">	    <span class="keyword">if</span> ([view.class.description isEqualToString:<span class="string">@&quot;MPVolumeSlider&quot;</span>])	&#123;</span><br><span class="line">	        volumeViewSlider = (<span class="built_in">UISlider</span> *)view;</span><br><span class="line">	        <span class="keyword">break</span>;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>然后再通过设置 <code>volumeViewSlider</code> 的 <code>value</code> 即可。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_volumeViewSlider.value = someVolume;</span><br></pre></td></tr></table></figure>

<h2 id="监听静音按钮"><a href="#监听静音按钮" class="headerlink" title="监听静音按钮"></a>监听静音按钮</h2><p>参考<a target="_blank" rel="noopener" href="http://sharkfood.com/content/Developers/content/Sound%20Switch/">Sound Switch - Sharkfood</a>的实现。</p>
<p>使用很简单，判断是否为静音模式：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ([SharkfoodMuteSwitchDetector shared].isMute) &#123;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>动态监听，通过 block 回调：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[SharkfoodMuteSwitchDetector shared].silentNotify = ^(<span class="type">BOOL</span> silent)&#123;</span><br><span class="line">      <span class="comment">// do something</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="监听耳机拔插"><a href="#监听耳机拔插" class="headerlink" title="监听耳机拔插"></a>监听耳机拔插</h2><p>监听 <code>AVAudioSessionRouteChangeNotification</code> 通知：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span></span><br><span class="line">									      selector:<span class="keyword">@selector</span>(audioRouteChangeListenerCallback:) 										      name:<span class="built_in">AVAudioSessionRouteChangeNotification</span> </span><br><span class="line">									        object:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>

<p>实现回调：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)audioRouteChangeListenerCallback:(<span class="built_in">NSNotification</span>*)notification</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *interuptionDict = notification.userInfo;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSInteger</span> routeChangeReason = [[interuptionDict valueForKey:<span class="built_in">AVAudioSessionRouteChangeReasonKey</span>] integerValue];</span><br><span class="line">    <span class="keyword">switch</span> (routeChangeReason) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">AVAudioSessionRouteChangeReasonNewDeviceAvailable</span>:</span><br><span class="line">            <span class="comment">// 耳机插入</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">AVAudioSessionRouteChangeReasonOldDeviceUnavailable</span>:</span><br><span class="line">            <span class="comment">// 耳机拔掉</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">case</span> <span class="built_in">AVAudioSessionRouteChangeReasonCategoryChange</span>:</span><br><span class="line">            <span class="comment">// called at start - also when other audio wants to play</span></span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;AVAudioSessionRouteChangeReasonCategoryChange&quot;</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<!-- processed 2 -->

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.wangruofeng007.com/2016/11/26/2016-11-26-dong-hua-qie-huan-imagezui-jia-shi-jian/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="王若风">
      <meta itemprop="description" content="王若风的技术博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王若风的技术博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/11/26/2016-11-26-dong-hua-qie-huan-imagezui-jia-shi-jian/" class="post-title-link" itemprop="url">动画切换 Image 最佳实践</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-11-26 20:42:40" itemprop="dateCreated datePublished" datetime="2016-11-26T20:42:40+08:00">2016-11-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-03 13:32:35" itemprop="dateModified" datetime="2024-11-03T13:32:35+08:00">2024-11-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%8A%A8%E7%94%BB/" itemprop="url" rel="index"><span itemprop="name">动画</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
  
    <a title="disqus" href="/2016/11/26/2016-11-26-dong-hua-qie-huan-imagezui-jia-shi-jian/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/11/26/2016-11-26-dong-hua-qie-huan-imagezui-jia-shi-jian/" itemprop="commentCount"></span>
    </a>
  </span>
  
 <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>846</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p> <code>UIImageView</code> 应该是iOS中使用最频换的控件，就如日常吃饭一样，天天都在重复，有时或许应该反思一下，怎么使用这个控件，达到低能耗，最佳用户体验。</p>
<p>针对单张图片来说，常见的处理是在图片准备显示时增加一个淡出动画，能使图片显示闲的很平滑。</p>
<p>多张图片也一样，在第一张图片的基础上淡出原来的图片，淡入新的图片。也可以说是溶解效果。</p>
<p>很多人喜欢对图片的 <code>alpha</code> 做淡出动画，使 <code>alpha</code> 从 0 到 1 动画改变。这种动画有一点不好的是，在动画结束后，图片会明显的出现一闪，这样使动画看起来有点突兀。比较好的做法时，在将要显示时给图片做一个转场动画。</p>
<h3 id="淡出动画实现"><a href="#淡出动画实现" class="headerlink" title="淡出动画实现"></a>淡出动画实现</h3><p>下面是其中一种简单的实现：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">UIImageView</span> (<span class="title">RFWebImage</span>)</span></span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>)animatedChangeToImage:(<span class="built_in">UIImage</span> *)img</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="built_in">UIView</span> transitionWithView:<span class="keyword">self</span></span><br><span class="line">                      duration:<span class="number">0.3</span>f</span><br><span class="line">                       options:<span class="built_in">UIViewAnimationOptionTransitionCrossDissolve</span></span><br><span class="line">                    animations:^&#123;</span><br><span class="line">                        <span class="keyword">self</span>.image = img;</span><br><span class="line">                    &#125; completion:<span class="literal">NULL</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p>思路：在 ImageView 将要显示是使用转场动画函数来实现淡出动画效果，体验应该是是各种动画中最好的了，而且使用起来很简单。</p>
<p>在淡出显示的动画基础上，我们引出今天的主角，动画切换 Image。</p>
<p>思路：单张图片淡出我们已经实现，现在做的就是在切换一张新的图片时同时再加入淡出或者说溶解效果即可。</p>
<h3 id="动画切换-Image"><a href="#动画切换-Image" class="headerlink" title="动画切换 Image"></a>动画切换 Image</h3><p>比较常见的有下面 3 种实现：</p>
<ul>
<li><code>CATransition</code> 类实现</li>
<li><code>UIView</code> 动画转场 API 实现</li>
<li><code>CABasicAnimation</code> 类实现</li>
</ul>
<h4 id="CATransition-实现"><a href="#CATransition-实现" class="headerlink" title="CATransition 实现"></a>CATransition 实现</h4><p> <code>CATransition</code> 类是iOS中很好用的控制转场动画的类，通过简单的配置可以实现常见而炫酷的动画效果，变换类型通过 <code>type</code> 字段控制， <code>subtype</code> 可以很细化控制动画的方向（比如动画开始的上下左右方向）。 <code>CATransition</code> 继承至 <code>CAAnimation</code> 可以对动画设置动画曲线（timingFunction），可以通过代理获取动画状态（是已经开始，还是已经停止，已经是否完成）。</p>
<p> <code>type</code> 支持四种类型：</p>
<ul>
<li>kCATransitionFade &#x2F;&#x2F; 淡入淡出</li>
<li>kCATransitionMoveIn &#x2F;&#x2F; 从某个方向向终点平移知道覆盖在上方</li>
<li>kCATransitionPush &#x2F;&#x2F; 把原来的推出去，自己推出去</li>
<li>kCATransitionReveal &#x2F;&#x2F; 把原来的从正上方解开，自己在下面</li>
</ul>
<p><em>下面是样板代码：</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)animatedSwichImageMethodOne &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UIImage</span> *toImage = [<span class="keyword">self</span> getRadomImage];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CATransition</span> *transition = [<span class="built_in">CATransition</span> animation];</span><br><span class="line">    transition.duration = <span class="number">0.3</span>f;</span><br><span class="line">    transition.timingFunction = [<span class="built_in">CAMediaTimingFunction</span> functionWithName:kCAMediaTimingFunctionEaseInEaseOut];</span><br><span class="line">    transition.type = kCATransitionFade;</span><br><span class="line">    transition.subtype = kCATransitionFromTop;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.imageViewOne.layer addAnimation:transition forKey:<span class="literal">nil</span>];</span><br><span class="line">    [<span class="keyword">self</span>.imageViewOne setImage:toImage];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="UIView-动画转场"><a href="#UIView-动画转场" class="headerlink" title="UIView 动画转场"></a>UIView 动画转场</h4><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="type">void</span>)transitionWithView:(<span class="built_in">UIView</span> *)view duration:(<span class="built_in">NSTimeInterval</span>)duration options:(<span class="built_in">UIViewAnimationOptions</span>)options animations:(<span class="type">void</span> (^ __<span class="keyword">nullable</span>)(<span class="type">void</span>))animations completion:(<span class="type">void</span> (^ __<span class="keyword">nullable</span>)(<span class="type">BOOL</span> finished))completion <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">4</span>_0);</span><br></pre></td></tr></table></figure>

<p>通过上面的函数实现，其实是对第一种的高级封装。通过设置 <code>options</code> 为 <code>UIViewAnimationOptionTransitionCrossDissolve</code> 即可。</p>
<p><em>下面是样板代码：</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)animatedSwichImageMethodTwo &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIImage</span> *toImage = [<span class="keyword">self</span> getRadomImage];</span><br><span class="line">    </span><br><span class="line">    [<span class="built_in">UIView</span> transitionWithView:<span class="keyword">self</span>.imageViewTwo</span><br><span class="line">                      duration:<span class="number">0.3</span>f</span><br><span class="line">                       options:<span class="built_in">UIViewAnimationOptionTransitionCrossDissolve</span> | <span class="built_in">UIViewAnimationOptionCurveEaseInOut</span></span><br><span class="line">                    animations:^&#123;</span><br><span class="line">                        <span class="keyword">self</span>.imageViewTwo.image = toImage;</span><br><span class="line">                    &#125; completion:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="CABasicAnimation-实现"><a href="#CABasicAnimation-实现" class="headerlink" title="CABasicAnimation 实现"></a>CABasicAnimation 实现</h4><p> <code>CABasicAnimation</code> 是核心动画一个重要的类，继承至 <code>CAPropertyAnimation</code> ，可以对所有的可动画属性做动画，可以通过 <code>fromValue</code> ， <code>toValue</code> ， <code>byValue</code> 字段控制动画的进度。<br>在这里我们是对 <code>CALayer</code> 的 <code>contents</code> 属性做动画，在改变图片时，创建一个 <code>CABasicAnimation</code> 对象添加到 ImageView 的图层上即可。</p>
<p><em>下面是样板代码：</em></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)animatedSwichImageMethodThree &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIImage</span> *toImage = [<span class="keyword">self</span> getRadomImage];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CABasicAnimation</span> *animation = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@&quot;contents&quot;</span>];</span><br><span class="line">    animation.toValue = toImage;</span><br><span class="line">    animation.duration = <span class="number">0.3</span>f;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.imageViewThree.layer addAnimation:animation forKey:<span class="string">@&quot;contentsAnimationKey&quot;</span>];</span><br><span class="line">    [<span class="keyword">self</span>.imageViewThree setImage:toImage];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>更多内容请下载<a target="_blank" rel="noopener" href="https://github.com/wangruofeng/AnimatedSwitchImageDemo">Demo</a>查看（<strong>🤔Bonus： Flip 效果🤔</strong>）</p>
</blockquote>
<!-- processed 2 -->

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.wangruofeng007.com/2016/11/17/2016-11-17-ioswu-feng-qiao-jie/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="王若风">
      <meta itemprop="description" content="王若风的技术博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王若风的技术博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/11/17/2016-11-17-ioswu-feng-qiao-jie/" class="post-title-link" itemprop="url">iOS 无缝桥接【翻译 Apple 官方文档】</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-11-17 23:52:46" itemprop="dateCreated datePublished" datetime="2016-11-17T23:52:46+08:00">2016-11-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-03 13:32:35" itemprop="dateModified" datetime="2024-11-03T13:32:35+08:00">2024-11-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">系统原理</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
  
    <a title="disqus" href="/2016/11/17/2016-11-17-ioswu-feng-qiao-jie/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/11/17/2016-11-17-ioswu-feng-qiao-jie/" itemprop="commentCount"></span>
    </a>
  </span>
  
 <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Toll-Free-Bridged-Types"><a href="#Toll-Free-Bridged-Types" class="headerlink" title="Toll-Free Bridged Types"></a>Toll-Free Bridged Types</h3><p>在 <code>Core Foundation</code> 框架和 <code>Foundation</code> 框架中有很多数据类型可以交替转换。能够被交替转换的数据类型也被叫做 <code>Toll-Free Bridged</code> 数据类型。这意味着你能像参数一样使用相同的数据结构对一个 <code>Core Foundation</code> 的函数进行调用，或者像 <code>Objective-C</code> 的消息接受模式一样执行。例如， <code>NSLocale</code> （查看<a target="_blank" rel="noopener" href="https://developer.apple.com/reference/foundation/nslocale">NSLocale Class Reference</a>）可以与在 <code>Core Foundation</code> 中对应的 <code>CFLocale</code> （查看<a target="_blank" rel="noopener" href="https://developer.apple.com/reference/corefoundation/1666963-cflocale">CFLocale Reference</a>）之间互相转换。</p>
<p>不是所有数据类型都是 <code>Toll-Free Bridged</code> ,即使它们的名字可能让你认为它们是。例如， <code>NSRunLoop</code> 是没有对应的桥接类型 <code>CFRunLoop</code> , <code>NSBundle</code> 也没有对应的桥接类型 <code>CFBundle</code> ， <code>NSDateFormatter</code> 同样没有对应的桥接类型 <code>CFDateFormatter</code> 。</p>
<p>文章末尾表 1 提供了一份支持无缝桥接的数据类型的列表。</p>
<blockquote>
<p><strong>注意</strong>：假如你使用一个自定义回调在一个 <code>Core Foundation</code> 框架的集合中，包含一个 <code>NULL</code> 回调，当使用 <code>Objective-C</code> 的方式接入它，它的内存管理方式是未定义的。</p>
</blockquote>
<h3 id="类型转换和对象语义周期声明"><a href="#类型转换和对象语义周期声明" class="headerlink" title="类型转换和对象语义周期声明"></a>类型转换和对象语义周期声明</h3><p>通过无缝桥接技术，在一个你以 <code>NSLocale *</code> 做为一个参数的方法的例子中，你能传递一个 <code>CFLocaleRef</code> 结构体，并且当你看到有一个 <code>CFLocaleRef</code> 参数的函数中，你能够传递一个 <code>NSLocale</code> 实例对象。当然你也必须提供给编译器相关的一些其它信息:第一，你必须转换一种类型成其它；第二，你可能必须指明对象的语义生命周期。</p>
<p>编译器理解 <code>Objective-C</code> 的方法并且返回 <code>Core Foundation</code> 数据类型，下面是 <code>Cocoa</code> 命名转换的历史（查看<a target="_blank" rel="noopener" href="https://developer.apple.com/library/content/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/MemoryMgmt.html#//apple_ref/doc/uid/10000011i">Advanced Memory Management Programming Guide</a>）。例如，编译器知道，在 <code>iOS</code> 中，通过 <code>UIColor</code> 的 <code>CGColor</code> 方法返回的 <code>CGColor</code> 并不应该被持有。你必须使用恰当的类型转换，像下面例子演示的那样：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSMutableArray</span> *colors = [<span class="built_in">NSMutableArray</span> arrayWithObject:(<span class="type">id</span>)[[<span class="built_in">UIColor</span> darkGrayColor] <span class="built_in">CGColor</span>]];</span><br><span class="line">[colors addObject:(<span class="type">id</span>)[[<span class="built_in">UIColor</span> lightGrayColor] <span class="built_in">CGColor</span>]];</span><br></pre></td></tr></table></figure>

<p>编译器并不会自动管理 <code>Core Foundation</code> 对象的生命周期。你必须告诉编译器对象的语义所属关系通过使用一种转换（定义在<strong>objc&#x2F;runtime.h</strong>）或者 <code>Core Foundation</code> 风格的宏（定义在 <strong>NSObject.h</strong>）：</p>
<ul>
<li><code>__bridge</code> 关键字表示转换指针在 <code>Objective-C</code> 和 <code>Core Foundation</code> 之间而不会转换所属关系。</li>
<li><code>__bridge_retained</code> 关键字或者 <code>CFBridgingRetain</code> 表示转换指针在 <code>Objective-C</code> 和 <code>Core Foundation</code> 之间并且把所属权交给你。你负责调用 <code>CFRelease</code> 或者相关的函数来交出对象的所属权。</li>
<li><code>__bridge_transfer</code> 关键字或者 <code>CFBridgingRelease</code> 表示转换一个非 <code>Objective-C</code> 的指针到 <code>Objective-C</code> 并且转换所属权给<strong>ARC</strong>。<strong>ARC</strong>负责交出对象的所属权。</li>
</ul>
<p>下面是一些例子：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSLocale</span> *gbNSLocale = [[<span class="built_in">NSLocale</span> alloc] initWithLocaleIdentifier:<span class="string">@&quot;en_GB&quot;</span>];</span><br><span class="line"><span class="built_in">CFLocaleRef</span> gbCFLocale = (__bridge <span class="built_in">CFLocaleRef</span>)gbNSLocale;</span><br><span class="line"><span class="built_in">CFStringRef</span> cfIdentifier = <span class="built_in">CFLocaleGetIdentifier</span>(gbCFLocale);</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;cfIdentifier: %@&quot;</span>, (__bridge <span class="built_in">NSString</span> *)cfIdentifier);</span><br><span class="line"><span class="comment">// Logs: &quot;cfIdentifier: en_GB&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">CFLocaleRef</span> myCFLocale = <span class="built_in">CFLocaleCopyCurrent</span>();</span><br><span class="line"><span class="built_in">NSLocale</span> *myNSLocale = (<span class="built_in">NSLocale</span> *)<span class="built_in">CFBridgingRelease</span>(myCFLocale);</span><br><span class="line"><span class="built_in">NSString</span> *nsIdentifier = [myNSLocale localeIdentifier];</span><br><span class="line"><span class="built_in">CFShow</span>((<span class="built_in">CFStringRef</span>)[<span class="string">@&quot;nsIdentifier: &quot;</span> stringByAppendingString:nsIdentifier]);</span><br><span class="line"><span class="comment">// Logs identifier for current locale</span></span><br></pre></td></tr></table></figure>

<p>下面的例子显示了使用口述的 <code>Core Foundation</code> 内存管理规则来管理 <code>Core Foundation</code> 内存：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)drawRect:(<span class="built_in">CGRect</span>)rect &#123;</span><br><span class="line">    <span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</span><br><span class="line">    <span class="built_in">CGColorSpaceRef</span> colorSpace = <span class="built_in">CGColorSpaceCreateDeviceGray</span>();</span><br><span class="line">    <span class="built_in">CGFloat</span> locations[<span class="number">2</span>] = &#123;<span class="number">0.0</span>, <span class="number">1.0</span>&#125;;</span><br><span class="line">    <span class="built_in">NSMutableArray</span> *colors = [<span class="built_in">NSMutableArray</span> arrayWithObject:(<span class="type">id</span>)[[<span class="built_in">UIColor</span> darkGrayColor] <span class="built_in">CGColor</span>]];</span><br><span class="line">    [colors addObject:(<span class="type">id</span>)[[<span class="built_in">UIColor</span> lightGrayColor] <span class="built_in">CGColor</span>]];</span><br><span class="line">    <span class="built_in">CGGradientRef</span> gradient = <span class="built_in">CGGradientCreateWithColors</span>(colorSpace, (__bridge <span class="built_in">CFArrayRef</span>)colors, locations);</span><br><span class="line">    <span class="built_in">CGColorSpaceRelease</span>(colorSpace);  <span class="comment">// Release owned Core Foundation object.</span></span><br><span class="line"> </span><br><span class="line">    <span class="built_in">CGPoint</span> startPoint = <span class="built_in">CGPointMake</span>(<span class="number">0.0</span>, <span class="number">0.0</span>);</span><br><span class="line">    <span class="built_in">CGPoint</span> endPoint = <span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMaxX</span>(<span class="keyword">self</span>.bounds), <span class="built_in">CGRectGetMaxY</span>(<span class="keyword">self</span>.bounds));</span><br><span class="line">    <span class="built_in">CGContextDrawLinearGradient</span>(ctx, gradient, startPoint, endPoint,</span><br><span class="line">                                kCGGradientDrawsBeforeStartLocation | kCGGradientDrawsAfterEndLocation);</span><br><span class="line">    <span class="built_in">CGGradientRelease</span>(gradient);  <span class="comment">// Release owned Core Foundation object.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="无缝桥接类型"><a href="#无缝桥接类型" class="headerlink" title="无缝桥接类型"></a>无缝桥接类型</h3><p>下面的表格提供了一个在 <code>Core Foundation</code> 和 <code>Foundation</code> 中可以交替转换数据类型列表。对每一对桥接类型，表也列举出了这些无缝桥接类型在 <code>OS X</code> 中的可用版本。</p>
<table>
<thead>
<tr>
<th align="left">Core Foundation 类型</th>
<th align="left">Foundation 类型</th>
<th align="center">可用性</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CFArrayRef</td>
<td align="left">NSArray</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFAttributedStringRef</td>
<td align="left">NSAttributedString</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFCalendarRef</td>
<td align="left">NSCalendar</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFCharacterSetRef</td>
<td align="left">NSCharacterSet</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFDataRef</td>
<td align="left">NSData</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFDateRef</td>
<td align="left">NSDate</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFDictionaryRef</td>
<td align="left">NSDictionary</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFErrorRef</td>
<td align="left">NSError</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFLocaleRef</td>
<td align="left">NSLocale</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFMutableArrayRef</td>
<td align="left">NSMutableArray</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFMutableAttributedStringRef</td>
<td align="left">NSMutableAttributedString</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFMutableCharacterSetRef</td>
<td align="left">NSMutableCharacterSet</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFMutableDataRef</td>
<td align="left">NSMutableData</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFMutableDictionaryRef</td>
<td align="left">NSMutableDict</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFMutableSetRef</td>
<td align="left">NSMutableSet</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFMutableStringRef</td>
<td align="left">NSMutableString</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFNumberRef</td>
<td align="left">NSNumber</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFReadStreamRef</td>
<td align="left">NSInputStream</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFRunLoopTimerRef</td>
<td align="left">NSTimer</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFSetRef</td>
<td align="left">NSSet</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFStringRef</td>
<td align="left">NSString</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFTimeZoneRef</td>
<td align="left">NSTimeZone</td>
<td align="center">OS X v10.4</td>
</tr>
<tr>
<td align="left">CFURLRef</td>
<td align="left">NSURL</td>
<td align="center">OS X v10.0</td>
</tr>
<tr>
<td align="left">CFWriteStreamRef</td>
<td align="left">NSOutputStream</td>
<td align="center">OS X v10.4</td>
</tr>
</tbody></table>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/library/content/documentation/CoreFoundation/Conceptual/CFDesignConcepts/Articles/tollFreeBridgedTypes.html">Toll-Free Bridged Types</a></li>
</ul>
<!-- processed 2 -->

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.wangruofeng007.com/2016/11/17/2016-11-17-blockbei-wang-lu/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="王若风">
      <meta itemprop="description" content="王若风的技术博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王若风的技术博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/11/17/2016-11-17-blockbei-wang-lu/" class="post-title-link" itemprop="url">block 备忘录</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-11-17 23:10:08" itemprop="dateCreated datePublished" datetime="2016-11-17T23:10:08+08:00">2016-11-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-03 13:32:35" itemprop="dateModified" datetime="2024-11-03T13:32:35+08:00">2024-11-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/" itemprop="url" rel="index"><span itemprop="name">系统原理</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
  
    <a title="disqus" href="/2016/11/17/2016-11-17-blockbei-wang-lu/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/11/17/2016-11-17-blockbei-wang-lu/" itemprop="commentCount"></span>
    </a>
  </span>
  
 <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>827</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>随著 <code>block</code> 在<strong>iOS4.0</strong>和<strong>OS X 10.6</strong>的引入，给事件传递一种新的方式实现，在开发中用得最多的场景莫过于事件回调。使用 <code>block</code> 相对与 <code>delegate</code> 的优势在于，业务集中，可读性强，代码内联，不像代理需要实现很多函数，在适当的场景选择这种方式实现事件传递或者传参效果非常好，现在很多开源项目都实现了两种方法的事件回调。</p>
<p> <code>block</code> 用起来虽然很爽，但也有它的不足，存在循环引用，轻者内存泄露，甚至导致App崩溃，不易调试追溯，因此使用它使一定要小心。鉴于实践中的踩过各种坑，总结下来，方便自己和他人以后查阅，这就是<strong>block备忘录</strong>写作的初衷。</p>
<h3 id="block-的本质"><a href="#block-的本质" class="headerlink" title="block 的本质"></a>block 的本质</h3><p> <code>block</code> 实际上是指向结构体的指针，编译时， <code>block</code> 的内部代码生产对应的函数。</p>
<p>具体结构如下：</p>
<p><img src="/images/block_structure.jpg" alt="block 结构图"></p>
<h3 id="与-C-语言的函数指针的区别"><a href="#与-C-语言的函数指针的区别" class="headerlink" title="与 C 语言的函数指针的区别"></a>与 C 语言的函数指针的区别</h3><ul>
<li><code>block</code> 的代码是内联的，效率高于函数调用</li>
<li><code>block</code> 对于外部变量默认是只读属性</li>
<li><code>block</code> 被 <code>Objective-C</code> 看成是对象处理</li>
</ul>
<h3 id="block-声明"><a href="#block-声明" class="headerlink" title="block 声明"></a>block 声明</h3><ul>
<li><p>作为 <code>property</code> 	&gt; @property (nonatomic, copy) returnType 	(^blockName)(parameterTypes);</p>
</li>
<li><p>作为方法参数</p>
<blockquote>
<p>- (void)someMethodThatTakesABlock:(returnType (^)(parameterTypes))blockName;
  </p>
</blockquote>
</li>
<li><p>作为一个方法调用参数</p>
<blockquote>
<p>[someObject someMethodThatTakesABlock:^returnType 	(parameters) {…}];
  </p>
</blockquote>
</li>
<li><p>作为一个 <code>typedef</code> 	&gt; typedef returnType (^TypeName)(parameterTypes);</p>
<blockquote>
<p>TypeName blockName &#x3D; ^returnType(parameters) {…};</p>
</blockquote>
</li>
<li><p>作为函数参数</p>
<blockquote>
<p>int (^sumOfNumbers)(int a, int b) &#x3D; ^(int a, int b) 	{<br>    return a + b;<br>};</p>
</blockquote>
</li>
</ul>
<h3 id="SDWebImage-中使用的-block-示例："><a href="#SDWebImage-中使用的-block-示例：" class="headerlink" title="SDWebImage 中使用的 block 示例："></a><code>SDWebImage</code> 中使用的 <code>block</code> 示例：</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">void</span>(^SDWebImageCompletionBlock)(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *error, SDImageCacheType cacheType, <span class="built_in">NSURL</span> *imageURL);</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">void</span>(^SDWebImageCompletionWithFinishedBlock)(<span class="built_in">UIImage</span> *image, <span class="built_in">NSError</span> *error, SDImageCacheType cacheType, <span class="type">BOOL</span> finished, <span class="built_in">NSURL</span> *imageURL);</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NSString</span> *(^SDWebImageCacheKeyFilterBlock)(<span class="built_in">NSURL</span> *url);</span><br></pre></td></tr></table></figure>

<h3 id="block-调用"><a href="#block-调用" class="headerlink" title="block 调用"></a>block 调用</h3><p>跟 C 函数类似使用 <code>（）</code> ，括号里面还可以带一个或者多个参数</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// block 声明</span></span><br><span class="line">（<span class="type">void</span>）(^loggerBlock)(<span class="type">void</span>); </span><br><span class="line"></span><br><span class="line"><span class="comment">// block 定义</span></span><br><span class="line">loggerBlock = ^&#123; </span><br><span class="line">     <span class="built_in">NSLog</span>(<span class="string">&quot;hello world&quot;</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// block 调用</span></span><br><span class="line">loggerBlock(); </span><br></pre></td></tr></table></figure>


<h3 id="block-内存管理"><a href="#block-内存管理" class="headerlink" title="block 内存管理"></a>block 内存管理</h3><p>默认情况下， <code>block</code> 是在栈内存中，它不会对所引用的对象进行任何操作；如果对 <code>block</code> 进行一次 <code>copy</code> 操作， <code>block</code> 就会在堆内存中，并且它会它所有的引用的对象做一次 <code>retain</code> 操作</p>
<ol>
<li>对于 block 外的变量引用，block 默认是将其复制到其数据结构中来实现访问的</li>
<li>对于用 <code>__block</code> 修饰的外部变量引用，block 是复制其引用地址来实现访问的</li>
<li>而 block 会捕获代码外的局部变量，并且仅限于只读操作</li>
<li>在 block 中希望修改的外界局部对象，必须加上 <code>__block</code> 关键词</li>
</ol>
<p>ARC</p>
<pre><code>如果对象使用 `__unsafe_unretained` 或 `__weak` 修饰，就不会对其做 `retain` 操作
</code></pre>
<p>MRC</p>
<pre><code>如果对象使用了 `__block` 修饰, 就不会对其做 `retain` 操作
</code></pre>
<p>为了防止 <code>block</code> 中的循环引用，可以用 <code>__weak</code> 关键词把相应的对象声明为弱引用,在 <code>block</code> 快内部需要多次访问，防止该对象被释放，可以用 <code>__strong</code> 关键词将声明为强引用：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__<span class="keyword">weak</span> __typeof__(<span class="keyword">self</span>) weakSelf = <span class="keyword">self</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, <span class="number">0</span>), ^&#123;</span><br><span class="line"></span><br><span class="line">    __<span class="keyword">strong</span> __<span class="keyword">typeof</span>(<span class="keyword">self</span>) strongSelf = weakSelf;</span><br><span class="line">    </span><br><span class="line">    [strongSelf doSomething];</span><br><span class="line">    [strongSelf doOtherThing];</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><ul>
<li><a target="_blank" rel="noopener" href="http://blog.devtang.com/2013/07/28/a-look-inside-blocks/">谈 Objective-C block 的实现</a></li>
<li><a target="_blank" rel="noopener" href="http://www.galloway.me.uk/2012/10/a-look-inside-blocks-episode-1/">A look inside blocks: Episode 1</a></li>
<li><a target="_blank" rel="noopener" href="http://www.galloway.me.uk/2012/10/a-look-inside-blocks-episode-2/">A look inside blocks: Episode 2</a></li>
<li><a target="_blank" rel="noopener" href="http://www.galloway.me.uk/2013/05/a-look-inside-blocks-episode-3-block-copy/">A look inside blocks: Episode 3</a></li>
<li><a target="_blank" rel="noopener" href="http://www.cnblogs.com/biosli/archive/2013/05/29/iOS_Objective-C_Block.html">对 Objective-C 中 Block 的追探</a></li>
<li><a target="_blank" rel="noopener" href="https://llvm.org/svn/llvm-project/compiler-rt/trunk/BlocksRuntime/Block_private.h">LLVM 中 block 实现源码</a></li>
<li><a target="_blank" rel="noopener" href="http://blog.parse.com/2013/02/05/objective-c-blocks-quiz/">objective-c-blocks-quiz</a></li>
<li><a target="_blank" rel="noopener" href="http://rypress.com/tutorials/objective-c/blocks.html">Blocks</a></li>
<li><a target="_blank" rel="noopener" href="http://www.jianshu.com/p/29d70274374b">iOS 开发-由浅至深学习 block</a></li>
</ul>
<!-- processed 2 -->

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.wangruofeng007.com/2016/10/23/2016-10-23-appchang-jian-beng-kui-wen-ti-fen-xi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="王若风">
      <meta itemprop="description" content="王若风的技术博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王若风的技术博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/10/23/2016-10-23-appchang-jian-beng-kui-wen-ti-fen-xi/" class="post-title-link" itemprop="url">App 常见崩溃问题分析</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-10-23 23:18:01" itemprop="dateCreated datePublished" datetime="2016-10-23T23:18:01+08:00">2016-10-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-03 13:32:35" itemprop="dateModified" datetime="2024-11-03T13:32:35+08:00">2024-11-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/" itemprop="url" rel="index"><span itemprop="name">最佳实践</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
  
    <a title="disqus" href="/2016/10/23/2016-10-23-appchang-jian-beng-kui-wen-ti-fen-xi/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/10/23/2016-10-23-appchang-jian-beng-kui-wen-ti-fen-xi/" itemprop="commentCount"></span>
    </a>
  </span>
  
 <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.3k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>12 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>此文是基于这些年工作中项目里面常见崩溃的一些总结，整理出来方便查阅，希望对大家都有所帮助。</p>
<h3 id="App-常见崩溃"><a href="#App-常见崩溃" class="headerlink" title="App 常见崩溃"></a>App 常见崩溃</h3><ol>
<li>数组下标越界</li>
<li>字典构造与修改</li>
<li><code>NSAttributedString</code> 相关</li>
<li>呈现一个空控制器</li>
<li>unrecognized selector</li>
<li>操作 <code>tableView</code> 数据</li>
<li>Push 到同一个控制器多次</li>
</ol>
<h4 id="1-数组下标越界"><a href="#1-数组下标越界" class="headerlink" title="1.数组下标越界"></a>1.数组下标越界</h4><p><strong>示例代码</strong>：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)testArrayOutOfBounds</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSArray</span> *testArray = @[@<span class="number">1</span>,@<span class="number">2</span>,@<span class="number">3</span>];</span><br><span class="line">    <span class="built_in">NSNumber</span> *num = testArray[<span class="number">3</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>异常现象</strong>：</p>
<p><em>Terminating app due to uncaught exception ‘NSRangeException’, reason: ‘*</em>* -[__NSArrayI objectAtIndex:]: index 3 beyond bounds [0 .. 2]’*</p>
<p><strong>预防方案</strong>：</p>
<p>在数组中取值时需要先进组下标索引边界检查，如果没有越界方可取值。</p>
<h4 id="2-字典构造造与修改"><a href="#2-字典构造造与修改" class="headerlink" title="2.字典构造造与修改"></a>2.字典构造造与修改</h4><p><strong>示例代码</strong>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (void)testDicSetNilValueCrash</span><br><span class="line">&#123;</span><br><span class="line">    // 构造不可变字典时 key 和 value 都不能为空</span><br><span class="line">    NSString *nilValue = nil;</span><br><span class="line">    NSString *nilKey = nil;</span><br><span class="line">    NSDictionary *dic1 = @&#123;@&quot;key&quot; : nilValue&#125;;</span><br><span class="line">    NSDictionary *dic2 = @&#123;nilKey : @&quot;value&quot;&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>异常现象</strong>：</p>
<p><em>Terminating app due to uncaught exception ‘NSInvalidArgumentException’, reason: ‘*</em>* -[__NSPlaceholderDictionary initWithObjects:forKeys:count:]: attempt to insert nil object from objects[0]’*</p>
<p><strong>预防方案</strong>：</p>
<p>在我们使用字面量快速创建一个字典的时候需要特别小心，因为很可能字典的键和值不能保证同时不为空。有潜在崩溃的风险，这种崩溃非常容易出现，需要特别小心，但是当你留心的话也非常好避免，就是设置字典的键或者值的时候判断是否非空，可变字典设置某个键的值是可以为空，相当于删除字典中的某个键值。为了使 App 保持健壮推荐使用 <code>KVO</code> 或者字面量的方式来设置字典的值</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)testMutableDicSetNilValueCrash</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *value = <span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">NSMutableDictionary</span> *mDic = [<span class="built_in">NSMutableDictionary</span> dictionary];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// via Dic set, leading crash</span></span><br><span class="line">    [mDic setObject:value forKey:<span class="string">@&quot;key&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// via KVO set, it&#x27;s safe</span></span><br><span class="line">    [mDic setValue:value forKey:<span class="string">@&quot;key&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// or via literal set, it&#x27;s safe</span></span><br><span class="line">    mDic[<span class="string">@&quot;key&quot;</span>] = value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="3-NSAttributedString-相关"><a href="#3-NSAttributedString-相关" class="headerlink" title="3.NSAttributedString 相关"></a>3.NSAttributedString 相关</h4><p><strong>示例代码</strong>：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)testAttributedStringInitCrash</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *nilStr = <span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">NSMutableAttributedString</span> *attributedStr = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:nilStr];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>)testAttributedStringAddAttributeCrash</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *nonnullStr = <span class="string">@&quot;str&quot;</span>;</span><br><span class="line">    <span class="built_in">NSMutableAttributedString</span> *attributedStr = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:nonnullStr];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSString</span> *nilValue = <span class="literal">nil</span>;</span><br><span class="line">    [attributedStr addAttribute:<span class="built_in">NSAttachmentAttributeName</span> value:nilValue range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, <span class="number">1</span>)];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>异常现象</strong>：</p>
<p><em>Terminating app due to uncaught exception ‘NSInvalidArgumentException’, reason: ‘NSConcreteMutableAttributedString initWithString:: nil value’</em></p>
<p><strong>预防方案</strong>：</p>
<p>在构造 <code>NSMutableAttributedString</code> 或者 <code>NSAttributedString</code> 需要留意，设置的属性的值是否有可能存在 <code>nil</code> 的情况。这个很容易被人忽视，值得注意。</p>
<h4 id="4-呈现一个空控制器"><a href="#4-呈现一个空控制器" class="headerlink" title="4.呈现一个空控制器"></a>4.呈现一个空控制器</h4><p><strong>示例代码</strong>：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)testPresentNilControllerCrash</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIViewController</span> *someVC = [<span class="built_in">UIViewController</span> new];</span><br><span class="line">    <span class="built_in">UIViewController</span> *presentVC = <span class="literal">nil</span>;</span><br><span class="line"></span><br><span class="line">    [someVC presentViewController:presentVC animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>异常现象</strong>：</p>
<p>present 一个空的控制器导致 App crash</p>
<p><strong>预防方案</strong>：</p>
<p>present 一个新控制器时，判断是否存在，存在才执行，否则直接返回</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)testPresentNilControllerCrashFixed</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIViewController</span> *someVC = [<span class="built_in">UIViewController</span> new];</span><br><span class="line">    <span class="built_in">UIViewController</span> *presentVC = [<span class="built_in">UIViewController</span> new];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (presentVC) &#123;</span><br><span class="line">        [someVC presentViewController:presentVC animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-unrecognized-selector"><a href="#5-unrecognized-selector" class="headerlink" title="5.unrecognized selector"></a>5.unrecognized selector</h4><p><strong>示例代码</strong>：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)testUnrecogernizedSelectorCash</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="keyword">self</span> performSelector:<span class="keyword">@selector</span>(testSel) withObject:<span class="literal">nil</span> afterDelay:<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>异常现象</strong>：</p>
<p><em>Terminating app due to uncaught exception ‘NSInvalidArgumentException’, reason: ‘-[ViewController testSel]: unrecognized selector sent to instance 0x7ffd41609d10’</em></p>
<p><strong>预防方案</strong>：</p>
<p>此类崩溃经常出现，特别是当服务器数据放回异常时，比如本来应该返回一个 <code>NSString</code> 类型字符串，结果返回 <code>NULL</code> ,当你调用字符串的 <code>length</code> 方式时，导致 App 崩溃。预防方法，重要的地方对类型进行判断再调用该类的相关方法，或者写一个分类统一处理此类逻辑。</p>
<h4 id="6-操作-tableView-数据"><a href="#6-操作-tableView-数据" class="headerlink" title="6.操作 tableView 数据"></a>6.操作 tableView 数据</h4><p><strong>示例代码</strong>：</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="type">void</span>)testTableViewUpdateCrash</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSIndexPath</span> *insertIndexPath = [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">0</span> inSection:<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">NSIndexPath</span> *deleteIndexPath = [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">1</span> inSection:<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">NSIndexPath</span> *reloadIndexPath = [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">2</span> inSection:<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">NSIndexPath</span> *moved1IndexPath = [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">3</span> inSection:<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">NSIndexPath</span> *moved2IndexPath = [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">4</span> inSection:<span class="number">0</span>];</span><br><span class="line">    [<span class="keyword">self</span>.tableView beginUpdates];</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span>.tableView insertRowsAtIndexPaths:@[insertIndexPath] withRowAnimation:<span class="built_in">UITableViewRowAnimationAutomatic</span>];</span><br><span class="line">    [<span class="keyword">self</span>.tableView deleteRowsAtIndexPaths:@[deleteIndexPath]withRowAnimation:<span class="built_in">UITableViewRowAnimationAutomatic</span>];</span><br><span class="line">    [<span class="keyword">self</span>.tableView reloadRowsAtIndexPaths:@[reloadIndexPath] withRowAnimation:<span class="built_in">UITableViewRowAnimationAutomatic</span>];</span><br><span class="line">    [<span class="keyword">self</span>.tableView moveRowAtIndexPath:moved1IndexPath toIndexPath:moved2IndexPath];</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span>.tableView endUpdates];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>异常现象</strong>：</p>
<p><em>Fatal Exception: NSInternalInconsistencyException</em></p>
<p><em>Invalid update: invalid number of sections. The number of sections contained in the table view after the update (1) must be equal to the number of sections contained in the table view before the update (1), plus or minus the number of sections inserted or deleted (1 inserted, 0 deleted).</em></p>
<p><strong>预防方案</strong>：</p>
<p>当需要动态更新 <code>tableView</code> 的数据时，计算好模型的数据使模型的数据和更新 <code>tableView</code> 的后的数据保持同步。</p>
<h4 id="7-Push-到同一个控制器多次"><a href="#7-Push-到同一个控制器多次" class="headerlink" title="7.Push 到同一个控制器多次"></a>7.Push 到同一个控制器多次</h4><p><strong>异常现象</strong>：</p>
<p>Fatal Exception: NSInvalidArgumentException</p>
<p>Pushing the same view controller instance more than once is not supported (&lt;PPSelectPayMethodViewControllerIOS7: 0x10d7e7f10&gt;)</p>
<p><strong>参考链接</strong>：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/nixzhu/dev-blog/blob/master/2016-01-04-duplicate-push.md">防止点击 Cell 时 ViewController 被重复 Push</a></li>
</ul>
<p>以上就是工作中常见的异常崩溃以及处理方案，下面的异常分类内容来自 <code>Apple</code> 的官方文档，有兴趣的可以查阅。☕️</p>
<h3 id="Apple-官方常见异常类型-Exception-types"><a href="#Apple-官方常见异常类型-Exception-types" class="headerlink" title="Apple 官方常见异常类型(Exception types)"></a>Apple 官方常见异常类型(Exception types)</h3><ol>
<li>访问一块坏内存 <code>[EXC_BAD_ACCESS] // SIGSEGV // SIGBUS]</code> 2. 异常退出 <code>[EXC_CRASH // SIGABRT]</code> 3. 追踪受限 <code>[EXC_BREAKPOINT // SIGTRAP]</code> 4. 非法指令 <code>[EXC_BAD_INSTRUCTION // SIGILL]</code> 5. 被保护的资源遭到侵害 <code>[EXC_GUARD]</code> 6. 资源限制 <code>[EXC_RESOURCE]</code> 7. 其他异常类型</li>
</ol>
<h4 id="1-访问一块坏内存-Bad-Memory-Access"><a href="#1-访问一块坏内存-Bad-Memory-Access" class="headerlink" title="1.访问一块坏内存(Bad Memory Access)"></a>1.访问一块坏内存(Bad Memory Access)</h4><p>当程序试图接入无效内容或者尝试以不被允许的方式接入由于内存的保护等级(例如，尝试写入只读的内存)。 <code>Exception Subtype</code> 字段包含一个<strong>kern_return_t</strong>结构体用来描述错误和不正确接入的内存地址。</p>
<p>下面是一些调试坏内存接入导致崩溃的建议：</p>
<ul>
<li>假如<strong>objc_msgSend</strong>或者<strong>objc_release</strong>在崩溃线程回溯(<strong>Backtraces</strong>)的顶部附近,这个线程可能尝试给一个释放的对象发消息。你应该 profile 应用使用<strong>Zombies instrument</strong>来更好的理解这个崩溃发生的条件。</li>
<li>假如<strong>gpus_ReturnNotPermittedKillClient</strong>在崩溃线程回溯(<strong>Backtraces</strong>)的顶部附近，线程被终结因为它尝试用<strong>OpenGL ES</strong>或者<strong>Metal</strong>执行渲染当程序处于后台时。查看<a target="_blank" rel="noopener" href="https://developer.apple.com/library/ios/qa/qa1766/_index.html">QA1766: How to fix OpenGL ES application crashes when moving to the background</a></li>
<li>打开 <code>Address Sanitizer</code> 运行你的应用。Address Sanitizer 添加了额外的说明在内容接入当你编译代码的时候。随着你应用的运行，Xcode 将⚠️你假如内存以一种可能导致崩溃的方式接入。</li>
</ul>
<h4 id="2-异常退出（Abnormal-Exit）"><a href="#2-异常退出（Abnormal-Exit）" class="headerlink" title="2.异常退出（Abnormal Exit）"></a>2.异常退出（Abnormal Exit）</h4><p>程序异常退出，是最常见导致这类异常崩溃的原因是捕获到 <code>Objective-C/C++</code> 异常和调用了 <code>abort()</code> 函数。</p>
<p><strong>App Extensions</strong>将被终结发生这种类型的异常，假如他们初始化花费太多的时间(<em>watchdog</em>终结)。假如一个<strong>extension</strong>由于载入时间太长被终结，产生崩溃报告的<strong>Exception Subtype</strong>将是<em>LAUNCH_HANG</em>。因为<strong>extensions</strong>并没有一个 <code>main</code> 函数，任何花销在初始化的时间都发生在<strong>static constructors</strong>和呈现在你的<strong>extensions</strong>和依赖库的 <code>+load</code> 方法。你应该尽可能的延迟做这些工作。</p>
<h4 id="3-追踪受限（Trace-Trap）"><a href="#3-追踪受限（Trace-Trap）" class="headerlink" title="3.追踪受限（Trace Trap）"></a>3.追踪受限（Trace Trap）</h4><p>和异常退出类似，这种异常的目的是给一个追加的调试器，让它有机会来打断在一个当它执行时候指定的点的进程。你可以使用 <code>__builtin_trap()</code> 函数在你的代码中来触发这个异常。假如没有调试器追加的话，线程将被终结并且产生一个崩溃报告。</p>
<p>低等级的库（例如<strong>libdispatch</strong>）将受限这个进程一旦遇到一个重大的错误。关于错误的额外信息可以在<a target="_blank" rel="noopener" href="https://developer.apple.com/library/content/technotes/tn2151/_index.html#//apple_ref/doc/uid/DTS40008184-CH1-APPINFO">Additional Diagnostic Information</a>章节中的崩溃报告找到，或者在设备的控制台。</p>
<p>假如在 <code>runtime</code> 遇到诸如下面的一个意外的条件， <code>Swift</code> 代码将终结出现这种类型的异常：</p>
<ul>
<li>非可选类型带有一个 <code>nil</code> 值</li>
<li>错误的强制类型转换</li>
</ul>
<p>查看<a target="_blank" rel="noopener" href="https://developer.apple.com/library/content/technotes/tn2151/_index.html#//apple_ref/doc/uid/DTS40008184-CH1-STACKTRACE">Backtraces</a>来决发生定异常条件的位置。额外的信息可能已经在设备的控制台打印出来了。你应该修改崩溃处的代码来优雅的处理 <code>runtime</code> 错误。例如，使用<a target="_blank" rel="noopener" href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/TheBasics.html">Optional Binding</a>而不是强制解包一个可选变量。</p>
<h4 id="4-非法指令（Illegal-Instruction）"><a href="#4-非法指令（Illegal-Instruction）" class="headerlink" title="4.非法指令（Illegal Instruction）"></a>4.非法指令（Illegal Instruction）</h4><p>进程尝试执行一个非法或者未定义的指令。进程可能已经尝试跳进到一个无效的地址通过一个配置错误的函数指针。在 <code>Intel</code> 处理器中， <code>ud2</code> 操作码导致一个<strong>EXC_BAD_INSTRUCTION</strong>异常，但是它通常被用来困住进程达到调试的目的。 <code>Swift</code> 代码在 <code>Intel</code> 处理器中将以这种异常终结，假如在 <code>runtime</code> 位置条件发生。更多详情查看<strong>Trace Trap</strong>。</p>
<h4 id="5-被保护的资源遭到侵害（Guarded-Resource-Violation）"><a href="#5-被保护的资源遭到侵害（Guarded-Resource-Violation）" class="headerlink" title="5.被保护的资源遭到侵害（Guarded Resource Violation）"></a>5.被保护的资源遭到侵害（Guarded Resource Violation）</h4><p>进程侵犯一个被保护的资源。系统库可能某个文件的描述器成 <code>guarded</code> ，在那以后，所有不正常的操作在这些描述器上都将触发一个<strong>EXC_GUARD</strong>异常（当它想操作在这些文件描述器上，系统可以使用特殊的 <code>guarded</code> 标记的私有 APIs）。这可以帮你向下快速追踪问题，例如关闭一个已经被系库打开的文件描述器。例如，假如一个 app 关闭文件秒杀器通过使用截图 <code>SQLite</code> 文件到一个 <code>Core Data</code> 存储， <code>Core Data</code> 将会在随后诡异的崩溃。<strong>guard exception</strong>将让这些问题尽早引起你的注意，这样也让他们变得更容易调试。</p>
<p>崩溃报告来自新版的 <code>iOS</code> 包含了人类可读的详细信息关于引起 <code>EXC_GUARD</code> 异常的操作在 <code>Exception Subtype</code> 和 <code>Exception Message</code> 字段中。在来自 <code>macOS</code> 或者老版本的 <code>iOS</code> 的崩溃报告中，这些信息被编码到第一个 <code>Exception Code</code> 就像一个分解成如下的位段：</p>
<ul>
<li><strong>[63:61] - Guard Type</strong>：被保护的资源类型。 <code>0x2</code> 代表一个文件描述器资源。</li>
<li><strong>[60:32] - Flavor</strong>：侵害被处罚时的条件<ul>
<li>假如第一个 <code>(1 &lt;&lt; 0)</code> 位被设置，进程尝试执行 <code>close()</code> 函数在一个受保护的文件描述器。</li>
<li>假如第二个 <code>(1 &lt;&lt; 1)</code> 位被设置，进程尝试执行 <code>dup()</code> ， <code>dup2()</code> ，或者 <code>fcntl()</code> 带 <code>F_DUPFD</code> 或者 <code>F_DUPFD_CLOEXEC</code> 命令在一个受保护的文件描述器。</li>
<li>假如第三个 <code>(1 &lt;&lt; 2)</code> 位被设置，进程尝试通过一个 <code>socket</code> 发送给一个受保护的文件描述器。</li>
<li>假如第三个 <code>(1 &lt;&lt; 3)</code> 位被设置，进程尝试写入到一个受保护的文件描述器。</li>
</ul>
</li>
<li><strong>[31:0] - File Descriptor</strong>：进程尝试修改的受保护的文件描述器。</li>
</ul>
<h4 id="6-资源限制（Resource-Limit）"><a href="#6-资源限制（Resource-Limit）" class="headerlink" title="6.资源限制（Resource Limit）"></a>6.资源限制（Resource Limit）</h4><p>进程超出了一个资源消耗的限制。这是一个来自操作系统通知，告诉进程正在使用的资源过多。精确的资源列在 <code>Exception Subtype</code> 字段中。假如 <code>Exception Note</code> 字段包含 <code>NON-FATAL CONDITION</code> ，进程不会被终结即使产生了一个崩溃报告。</p>
<ul>
<li><p>异常子类型 <code>MEMORY</code> 表明进程已经越过系统应用的内存限制。这可能是一个终结的先兆由于超额的使用内存。</p>
</li>
<li><p>异常子类型 <code>WAKEUPS</code> 表明在进程中的线程每秒被唤醒太多次，这强制 <code>CPU</code> 非常频繁的唤醒消耗电池寿命。</p>
<p>  典型的，这个通过由线程与线程的通信产生（通常是使用 <code>peformSelector:onThread:</code> 或 <code>dispatch_async</code> ）,那样无意的发生了远远超出它正常应该的切换频率。因为通信的协调发生得非常频繁而出发此类的异常，这个通常和多个后台线程有着相似 <code>Backtraces</code> – 表明那些地方发生过通信。</p>
</li>
</ul>
<h4 id="7-其他异常类型（Other-Exception-Types）"><a href="#7-其他异常类型（Other-Exception-Types）" class="headerlink" title="7.其他异常类型（Other Exception Types）"></a>7.其他异常类型（Other Exception Types）</h4><p>一些崩溃报告可能含有一个未命名的 <code>Exception Type</code> ，将以一个 16 进制的值（例如，00000020）的形式打印。假如你的设备收到了一个这样的崩溃报告，直接查看 <code>Exception Codes</code> 字段寻找更多的信息。</p>
<ul>
<li><p>异常代码 <code>0xbaaaaaad</code> 表明记录是整个系统的 <code>stackshot</code> ，不是一个崩溃报告。为了获得一个 <code>stackshot</code> ，按 <code>Home</code> 键和任意音量键。这些记录经常被用户偶然创建，并不表明是一个错误。</p>
</li>
<li><p>异常代码 <code>0xbad22222</code> 表明一个 <code>VoIP</code> 应用已经被 <code>iOS</code> 终结，因为它启动得太频繁。</p>
</li>
<li><p>异常代码 <code>0x8badf00d</code> 表明应用已经被 <code>iOS</code> 终结因为发生 <code>watchdog</code> 超时。应用花费太长时间启动，终结，或者响应系统事件。通常导致这歌问题是做了<a target="_blank" rel="noopener" href="http://developer.apple.com/library/ios/qa/qa1693/">在主线程执行了同步的网络请求</a>。无论什么操作在 <code>Thread 0</code> 都需要移动到后台线程，或者异步处理，以免它阻塞主线程。</p>
</li>
<li><p>异常代码 <code>0xc00010ff</code> 表明引用被操作系统终结为了响应一个发热事件。这个可能由于一个发生崩溃的特定的设备的问题或者环境被操作导致。为了使你的应用更高效运行的建议，查看<strong>WWDC session</strong><a target="_blank" rel="noopener" href="https://developer.apple.com/videos/wwdc/2011/?id=312"> iOS Performance and Power Optimization with Instruments</a>。</p>
</li>
<li><p>异常代码 <code>0xdead10cc</code> 表明应用被 <code>iOS</code> 终结，由于当在后台运行时它持有了一个系统的资源（像通信录数据库）。</p>
</li>
<li><p>异常代码 <code>0xdeadfa11</code> 表明应用被用户强制退出。强制退出发生在当用户第一次按下开关机按钮直到”滑动来关机”出现，然后在按下 Home 键。这是合理的假如用户这样做了，因为应用已经变得不可响应，但是这并不能保证 - 强制退出任何正在运行的任务。</p>
<blockquote>
<p>注意：终结一个挂起的 app 通过从多任务关系面板中移除并不会产生一个崩溃报告。一旦一个 app 被挂起，<strong>iOS</strong>它有资格在任何时候终结它，所有没有崩溃报告产生。</p>
</blockquote>
</li>
</ul>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/library/content/technotes/tn2151/_index.html">Understanding and Analyzing Application Crash Reports</a></li>
<li><a target="_blank" rel="noopener" href="https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/AnalyzingCrashReports/AnalyzingCrashReports.html">Analyzing Crash Reports</a></li>
</ul>
<!-- processed 2 -->

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.wangruofeng007.com/2016/09/10/2016-09-10-kuai-su-feng-zhuang-airbnbfeng-ge-loadingview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="王若风">
      <meta itemprop="description" content="王若风的技术博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王若风的技术博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/09/10/2016-09-10-kuai-su-feng-zhuang-airbnbfeng-ge-loadingview/" class="post-title-link" itemprop="url">快速封装 Airbnb 风格 Loadingview</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-09-10 13:54:15" itemprop="dateCreated datePublished" datetime="2016-09-10T13:54:15+08:00">2016-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-03 13:32:35" itemprop="dateModified" datetime="2024-11-03T13:32:35+08:00">2024-11-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%8A%A8%E7%94%BB/" itemprop="url" rel="index"><span itemprop="name">动画</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
  
    <a title="disqus" href="/2016/09/10/2016-09-10-kuai-su-feng-zhuang-airbnbfeng-ge-loadingview/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/09/10/2016-09-10-kuai-su-feng-zhuang-airbnbfeng-ge-loadingview/" itemprop="commentCount"></span>
    </a>
  </span>
  
 <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>944</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>一直在观察各种 App 的 <code>LoadingView</code> ，比较有代表性的是 <code>MBProgressVHUD</code> ， <code>SVProgressHUD</code> ，这两个使用得非常广泛，大到 QQ，支付宝，小到各种不知道名的 App，长时间的迭代让它们的逻辑非常完善，同时也导致了有些累赘，如果把它们当一个产品来分析，可以看出，它们在不断地增加需求和使用场景，有没有一个非常简洁的 HUD 没有我们不需要的那些多余的逻辑只是负责显示指示和隐藏呢？</p>
<p>好像没有，所有今天动手准备自己封装一个 <code>LoadingView</code> ，灵感来自 Airbnb，用过 Airbnb 的同学都知道，它的 <code>LoadingView</code> 很有风格,Airbnb 是几张图片循环翻转切换，当然我不准备复制他们的 idea，我准备做一个循环左右上下切换的 <code>LoadingView</code> 。</p>
<img src="/images/loading_img/loading_img_01.jpg" width="375" height="667">

<p>废话不多说，先来看一下，最终效果的原型图</p>
<p><img src="/images/loading_img/loading_img_02.jpg" alt="RFLoadingView"></p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>分析一下思路：</p>
<ul>
<li>四条虚线交叉形成的区域就是我们能够看到的图片</li>
<li>首先准备两张图片，位置 中+上</li>
<li>开始第一段动画，向下切换，位置 变成 中+下</li>
<li>第一段动画结束，将下面的图片移动到右边，准备开始第二段动画</li>
<li>第二动画跟第一段类似，只是方向是从右向左，动画结束后 位置变成 中+左</li>
<li>将左边的图片移动到上方位置，完成一个循环</li>
</ul>
<p> 为了使动画更流畅不至于生硬，我们使用 iOS7 推出的带弹簧效果的 API</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">+ (<span class="type">void</span>)animateWithDuration:(<span class="built_in">NSTimeInterval</span>)duration delay:(<span class="built_in">NSTimeInterval</span>)delay usingSpringWithDamping:(<span class="built_in">CGFloat</span>)dampingRatio initialSpringVelocity:(<span class="built_in">CGFloat</span>)velocity options:(<span class="built_in">UIViewAnimationOptions</span>)options animations:(<span class="type">void</span> (^)(<span class="type">void</span>))animations completion:(<span class="type">void</span> (^ __<span class="keyword">nullable</span>)(<span class="type">BOOL</span> finished))completion <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">7</span>_0);</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<h3 id="API-接口"><a href="#API-接口" class="headerlink" title="API 接口"></a>API 接口</h3><p>在 API 接口设计上，我希望尽量简单实用，封装了两个方法，一个用来显示，一个用来隐藏，可以指定显示到某个 view，以及指定显示和隐藏时是否使用动画。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line">+ (<span class="type">void</span>)showViewAddedTo:(<span class="built_in">UIView</span> *)view animated:(<span class="type">BOOL</span>)animated;</span><br><span class="line">+ (<span class="type">void</span>)hideViewForView:(<span class="built_in">UIView</span> *)view animated:(<span class="type">BOOL</span>)animated;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="API-实现"><a href="#API-实现" class="headerlink" title="API 实现"></a>API 实现</h3><p>根据刚才的分析，核心的动画实现已经有了思路，现在就是怎么设计内部代码实现，为了方便显示蒙版阻止加载的时候用户交互，我把 view 的背景颜色设置了一个淡灰色，view 的中间有三个子 view，一个是位于中间的容器 <code>centralView</code> ,负责显示我们所看到的区域，方便实现圆角和动画效果，里面加入两个子 view， <code>firstView</code> 和 <code>secondView</code> 用于显示动画切换的图片。</p>
<p>内部接口大概这样</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIView</span>      *centralView;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIImageView</span> *firstView;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">UIImageView</span> *secondView;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>为了防止多次添加 <code>LoadingView</code> ，在每次添加前，我们会查找该 view 是否存在，如果不存在，创建一个新的对象，如果存在直接跳过添加操作。反向遍历，快速查找。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">+ (RFLoadingView *)loadingViewForView:(<span class="built_in">UIView</span> *)view</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSEnumerator</span> *subviewsEnum = [view.subviews reverseObjectEnumerator];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">UIView</span> *subview <span class="keyword">in</span> subviewsEnum) &#123;</span><br><span class="line">        <span class="keyword">if</span> ([subview isKindOfClass:<span class="keyword">self</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> (RFLoadingView *)subview;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>动画核心实现,两端动画，封装成两个方法</p>
<ul>
<li><code>- (void)animatedImageFromTopToBottom</code> * <code>- (void)animatedImageFromTopToBottom</code> 具体实现如下</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- (<span class="type">void</span>)animatedImageFromTopToBottom</span><br><span class="line">&#123;</span><br><span class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.3</span> delay:<span class="number">0.5</span> usingSpringWithDamping:<span class="number">0.7</span> initialSpringVelocity:<span class="number">0</span> options:<span class="built_in">UIViewAnimationOptionCurveEaseInOut</span> animations:^&#123;</span><br><span class="line">        _firstView.centerY  += kCenterViewSize;</span><br><span class="line">        _secondView.centerY += kCenterViewSize;</span><br><span class="line">    &#125; completion:^(<span class="type">BOOL</span> finished) &#123;</span><br><span class="line">        _firstView.centerX += kCenterViewSize;</span><br><span class="line">        _firstView.centerY -= kCenterViewSize;</span><br><span class="line">        </span><br><span class="line">        [<span class="keyword">self</span> changeFirstImage];</span><br><span class="line">        [<span class="keyword">self</span> animatedImageFromRightToLeft];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="type">void</span>)animatedImageFromRightToLeft</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.3</span> delay:<span class="number">0.5</span> usingSpringWithDamping:<span class="number">0.7</span> initialSpringVelocity:<span class="number">0</span> options:<span class="built_in">UIViewAnimationOptionCurveEaseInOut</span> animations:^&#123;</span><br><span class="line">        _firstView.centerX  -= kCenterViewSize;</span><br><span class="line">        _secondView.centerX -= kCenterViewSize;</span><br><span class="line">    &#125; completion:^(<span class="type">BOOL</span> finished) &#123;</span><br><span class="line">        _secondView.centerX += kCenterViewSize;</span><br><span class="line">        _secondView.centerY -= kCenterViewSize;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">self</span>.alpha &amp;&amp; <span class="keyword">self</span>) &#123;</span><br><span class="line">            [<span class="keyword">self</span> changeSecondImage];</span><br><span class="line">            [<span class="keyword">self</span> animatedImageFromTopToBottom];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>需要非常注意的是，一定要写上终止动画的条件，不然会无限循环，影响性能</p>
</blockquote>
<h3 id="show-和-hide"><a href="#show-和-hide" class="headerlink" title="show 和 hide"></a>show 和 hide</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">- (void)showAnimated:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">    RFMainThreadAssert();</span><br><span class="line">    </span><br><span class="line">    self.alpha = 1;</span><br><span class="line">    </span><br><span class="line">    [UIView animateWithDuration:animated ? 0.3 : 0 animations:^&#123;</span><br><span class="line">        _centralView.alpha = 1;</span><br><span class="line">    &#125; completion:^(BOOL finished) &#123;</span><br><span class="line">        [self animatedImageFromTopToBottom];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)hideAnimated:(BOOL)animated</span><br><span class="line">&#123;</span><br><span class="line">    RFMainThreadAssert();</span><br><span class="line">    </span><br><span class="line">    [UIView animateWithDuration:animated ? 0.3 : 0 animations:^&#123;</span><br><span class="line">        self.alpha = 0;</span><br><span class="line">    &#125; completion:^(BOOL finished) &#123;</span><br><span class="line">        [self removeFromSuperview];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h3><img src="/images/loading_img/loading_img_03.jpg" width="375" height="667">

<ul>
<li>Github Demo 地址:<br><a target="_blank" rel="noopener" href="https://github.com/wangruofeng/RFLoadingView">RFLoadingViewDemo</a></li>
</ul>
<!-- processed 2 -->

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://blog.wangruofeng007.com/2016/04/15/2016-04-15-iosdi-san-fang-ku-hui-zong/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="王若风">
      <meta itemprop="description" content="王若风的技术博客">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="王若风的技术博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/04/15/2016-04-15-iosdi-san-fang-ku-hui-zong/" class="post-title-link" itemprop="url">iOS 第三方库汇总</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-04-15 17:23:38" itemprop="dateCreated datePublished" datetime="2016-04-15T17:23:38+08:00">2016-04-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-11-03 13:32:35" itemprop="dateModified" datetime="2024-11-03T13:32:35+08:00">2024-11-03</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%B5%84%E6%96%99%E6%94%B6%E9%9B%86/" itemprop="url" rel="index"><span itemprop="name">资料收集</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
  
    <a title="disqus" href="/2016/04/15/2016-04-15-iosdi-san-fang-ku-hui-zong/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2016/04/15/2016-04-15-iosdi-san-fang-ku-hui-zong/" itemprop="commentCount"></span>
    </a>
  </span>
  
 <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>此文用于总结，本人使用过或者收藏过的 <code>Github</code> 第三方类库，以便日后查阅，也便他人借鉴。</p>
<p>资料整理中不定期更新…</p>
<h3 id="开源项目"><a href="#开源项目" class="headerlink" title="开源项目"></a>开源项目</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/thedillonb/CodeHub">CodeHub</a><blockquote>
<p>browse and maintain your GitHub repositories on any iOS device!</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/dkhamsing/open-source-ios-apps">Open-Source iOS Apps</a><blockquote>
<p>开源 iOS apps 列表</p>
</blockquote>
</li>
</ul>
<h3 id="APP-相关"><a href="#APP-相关" class="headerlink" title="APP 相关"></a>APP 相关</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/nicklockwood/iVersion">iVersion</a><blockquote>
<p>提示版本更新</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/Raizlabs/BonMot">BonMot</a><blockquote>
<p>字体相关的库，设置字体样式</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/PrideChung/FontAwesomeKit">FontAwesomeKit</a><blockquote>
<p>FontAwesomeKit 提供一些简单的助手类用来帮助在 iOS 上使用<a target="_blank" rel="noopener" href="https://github.com/FortAwesome/Font-Awesome">FontAwesome</a></p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/FortAwesome/Font-Awesome">Font-Awesome</a><blockquote>
<p>The iconic font and CSS toolkit	</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/leverdeterre/JMHoledView">JMHoledView</a><blockquote>
<p>首次启动 APP 的新手指引</p>
</blockquote>
</li>
</ul>
<h3 id="自动布局"><a href="#自动布局" class="headerlink" title="自动布局"></a>自动布局</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/cloudkite/Masonry">Masonry</a><blockquote>
<p>最优雅的自动布局解决方案，支持链式编程</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/PureLayout/PureLayout">PureLayout</a><blockquote>
<p>又一强大的自动布局解决方案</p>
</blockquote>
</li>
</ul>
<h3 id="网络请求"><a href="#网络请求" class="headerlink" title="网络请求"></a>网络请求</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/AFNetworking/AFNetworking">AFNetworking</a><blockquote>
<p>地球人都在用</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/robbiehanson/CocoaAsyncSocket">CocoaAsyncSocket</a><blockquote>
<p>封装最完善的 Socket 类库</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/RxSwiftCommunity/RxAlamofire">RxAlamofire</a><blockquote>
<p>封装 Alamofire</p>
</blockquote>
</li>
</ul>
<h3 id="基础工具类以及-Category"><a href="#基础工具类以及-Category" class="headerlink" title="基础工具类以及 Category"></a>基础工具类以及 Category</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/soffes/sstoolkit">sstoolkit</a><blockquote>
<p>一个不错的工具包，提供各种比如编码、加密、字符串处理等等东西</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/FabrizioBrancati/BFKit-Swift">BFKit Swift 版本</a><blockquote>
<p>国外的一个大神写的很好用的分类，比较齐全</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ibireme/YYKit">YYKit</a><blockquote>
<p><strong>ibireme</strong>用心之作</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://zwaldowski.github.io/BlocksKit">BlocksKit</a><blockquote>
<p>为基础类提供 Block 支持，很好用</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/MatthewYork/DateTools">DateTools</a><blockquote>
<p>非常强大的日期处理工具</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/Grouper/FlatUIKit">FlatUIKit</a><blockquote>
<p>扩展 Foundation 基本 UI 主件，扁平化风格</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/shaojiankui/iOS-Categories">iOS-Categories</a><blockquote>
<p>iOS Objective-C Category, a collection of useful Objective-C Categories extending iOS Frameworks such as Foundation,UIKit,CoreData,QuartzCore,CoreLocation,MapKit Etc.</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/kimziv/PinYin4Objc">PinYin4Objc</a><blockquote>
<p>拼音解析</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/mattconnolly/ZipArchive">ZipArchive</a><blockquote>
<p>解压缩</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ViccAlexander/Chameleon">Chameleon</a><blockquote>
<p>扁平颜色框架，可以创建非常漂亮的颜色</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ChenYilong/CYLTabBarController">CYLTabBarController</a><blockquote>
<p>低耦合集成 TabBarController</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/cwRichardKim/RKNotificationHub">RKNotificationHub</a><blockquote>
<p>在右上方显示通知小角标</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/fpt-software/Material-Controls-For-iOS">Material-Controls-For-iOS</a><blockquote>
<p>Google 风格的控件</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/wangruofeng/YYKit">YYKit</a><blockquote>
<p>A collection of iOS components.</p>
</blockquote>
</li>
</ul>
<h3 id="弹框"><a href="#弹框" class="headerlink" title="弹框"></a>弹框</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/12207480/TYAlertController">TYAlertController</a><blockquote>
<p>各种风格的弹框，满足你的各种需求</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/UncleJoke/JKPopMenuView">JKPopMenuView</a><blockquote>
<p>简单的弹出菜单</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/adad184/MMPopupView">MMPopupView</a><blockquote>
<p>精简的弹框，非常漂亮，和喜欢</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/martinjuhasz/MJPopupViewController">MJPopupViewController</a><blockquote>
<p>A UIViewController Category to display a ViewController as a popup with different transition effects.</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/questbeat/QBPopupMenu.git">QBPopupMenu</a><blockquote>
<p>自定义 popup menu，外观和 iOS7 上的 <code>UIMenuController</code> 类似</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/cezarywojcik/CWStatusBarNotification">CWStatusBarNotification</a><blockquote>
<p>状态栏通知</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/12207480/DOPDropDownMenu-Enhanced">DOPDropDownMenu</a><blockquote>
<p>下拉列表菜单</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/jmascia/KLCPopup">KLCPopup</a><blockquote>
<p>非常漂亮的弹出控件</p>
</blockquote>
</li>
</ul>
<h3 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/jhurray/JHChainableAnimations">JHChainableAnimations</a><blockquote>
<p>链式动画编程，有点 Masonry 的味道</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="http://canvaspod.io/">Canvas</a><blockquote>
<p>非常强大的动画框架</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ColinEberhardt/VCTransitionsLibrary">VCTransitionsLibrary</a><blockquote>
<p>转场动画库</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/nicklockwood/iCarousel">iCarousel</a><blockquote>
<p>各种 3D 变换的动画，以前用过，炫酷得没朋友</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/devinross/tapkulibrary">tapkulibrary</a><blockquote>
<p>Tapku remain home to the things like the calendar UIs, coverflow, and any legacy classes, ect.</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/AlexeyBelezeko/TBIconTransitionKit">TBIconTransitionKit</a><blockquote>
<p>点击按钮过渡动画 + –&gt; x - –&gt; + </p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/MengTo/Spring">Spring</a><blockquote>
<p>A library to simplify iOS animations in <code>Swift</code> * <a target="_blank" rel="noopener" href="https://github.com/sxyx2008/awesome-ios-animation">awesome-iOS-animation</a><br>iOS 动画库整理收集</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/NghiaTranUIT/FeSpinner">FeSpinner</a><blockquote>
<p>Rocket Loader Collection for iOS app,有一些非常有趣的 loading 动画</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/seedante/SDECollectionViewAlbumTransition">SDECollectionViewAlbumTransition</a><blockquote>
<p>CollectionView 相册自定义转场</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/Raizlabs/RZTransitions">RZTransitions</a> <blockquote>
<p>A library of custom iOS View Controller Animations and Interactions.</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/shu223/AnimatedTransitionGallery">AnimatedTransitionGallery</a><blockquote>
<p>各种自定义转场动画收集，非常值得学习</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/Yalantis/StarWars.iOS">StarWars.iOS</a><blockquote>
<p>非常炫酷的 <code>CAShapeLayer</code> 动画，非常炫酷😘</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/YouXianMing/Animations">Animations</a><blockquote>
<p>来自极客学院的 <code>YouXianMing</code> 的一些动画收集</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/zoonooz/ZFDragableModalTransition">ZFDragableModalTransition</a><blockquote>
<p>Custom animation transition for present modal view controller</p>
</blockquote>
</li>
</ul>
<h3 id="Gif-引擎"><a href="#Gif-引擎" class="headerlink" title="Gif 引擎"></a>Gif 引擎</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/Flipboard/FLAnimatedImage">FLAnimatedImage</a><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/Flipboard">Flipboard</a>开源的 <code>Gif</code> 引擎</p>
</blockquote>
</li>
</ul>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/REN-LEI/RENCache">RENCache</a><blockquote>
<p>简单的缓存解决方案</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/rnapier/RNCachingURLProtocol">RNCachingURLProtocol</a><blockquote>
<p>webView 离线缓存库</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/Haneke/HanekeSwift">HanekeSwift</a><blockquote>
<p>Swift 语言书写的轻量级图片缓存框架</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/path/FastImageCache">FastImageCache</a><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/path">Path</a>官方开源的图片缓存框架</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/onevcat/Kingfisher">Kingfisher</a><blockquote>
<p>猫神用 Swift 实现图片下载缓存框架</p>
</blockquote>
</li>
</ul>
<h3 id="文本相关"><a href="#文本相关" class="headerlink" title="文本相关"></a>文本相关</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/TTTAttributedLabel/TTTAttributedLabel">TTTAttributedLabel</a><blockquote>
<p>非常强大的 Label，支持属性，数据诊断和链接</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/slackhq/SlackTextViewController.git">SlackTextViewController</a><blockquote>
<p><code>Slack</code> 开源的 drop-in UIViewController subclass with a growing text input view and other useful messaging features</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/honcheng/RTLabel">RTLabel</a><blockquote>
<p>可以展示 Html 的 Label</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/12207480/TYAttributedLabel">TYAttributedLabel</a><blockquote>
<p>强大的属性文本控件(无需了解 <code>CoreText</code> )，支持图文混排显示，支持添加链接，image 和 UIView 控件，支持自定义排版显示</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/cloverstudio/CSGrowingTextView">CSGrowingTextView</a><blockquote>
<p>文本框会随着输入字数改变高度</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/lexrus/LTMorphingLabel">LTMorphingLabel</a><blockquote>
<p>效果非常炫的文本框</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/raulriera/TextFieldEffects">TextFieldEffects</a><blockquote>
<p>动效非常不错的文本输入框</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/daiweilai/DDRichText">DDRichText</a><blockquote>
<p>图文混排</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/AirSars/BMLine">BMLine</a><blockquote>
<p>为你的 View 增加线条</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/devxoul/UITextView-Placeholder">UITextView-Placeholder</a><blockquote>
<p>A missing placeholder for UITextView.</p>
</blockquote>
</li>
</ul>
<h3 id="加载进度"><a href="#加载进度" class="headerlink" title="加载进度"></a>加载进度</h3><ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/danielamitay/DACircularProgress">DACircularProgress</a></p>
<blockquote>
<p>各种圆形和圆环型进度指示</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/ninjinkun/NJKWebViewProgress">NJKWebViewProgress</a></p>
<blockquote>
<p>UIWebView progress interface</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/jdg/MBProgressHUD">MBProgressHUD</a></p>
<blockquote>
<p>这个不用讲，基本上都会用</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/SVProgressHUD/SVProgressHUD">SVProgressHUD</a></p>
<blockquote>
<p>又一个进度指示</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/scalessec/Toast">Toast</a></p>
<blockquote>
<p>和 MBProgressHUD 差不多</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/LeoiOS/LCProgressHUD">LCProgressHUD</a></p>
<blockquote>
<p>对 MBProgressHUD 的简单封装，非常实用</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/KrauseFx/TSMessages/">TSMessages</a></p>
<blockquote>
<p>消息通知提醒框，非常好用</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/pinterest/PINRemoteImage">PINRemoteImage</a></p>
<blockquote>
<p><code>Pinterest</code> 抓取远程图片类</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/rs/SDWebImage">SDWebImage</a></p>
<blockquote>
<p>最广泛使用的图片缓存框架</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/Alamofire/AlamofireImage">AlamofireImage</a></p>
<blockquote>
<p>Swift 版本的 <code>SDWebImage</code> ### 键盘类</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/danielamitay/DAKeyboardControl">DAKeyboardControl</a></p>
<blockquote>
<p>一个键盘管理框架</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/hackiftekhar/IQKeyboardManager">IQKeyboardManager</a></p>
<blockquote>
<p>全局键盘管理</p>
</blockquote>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/michaeltyson/TPKeyboardAvoiding">TPKeyboardAvoiding</a></p>
<blockquote>
<p>使用时设置 scrollView 的类为 <code>TPKeyboardAvoidingScrollView</code> 即可支持 <code>xib</code> * <a target="_blank" rel="noopener" href="https://github.com/datwelk/RDRStickyKeyboardView">RDRStickyKeyboardView</a><br>作者已经停止维护…</p>
</blockquote>
</li>
</ul>
<h3 id="抽屉"><a href="#抽屉" class="headerlink" title="抽屉"></a>抽屉</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/ViewDeck/ViewDeck">ViewDeck</a><blockquote>
<p>功能强大的抽屉效果</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/mutualmobile/MMDrawerController">MMDrawerController</a><blockquote>
<p>又一个抽屉</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/John-Lluch/SWRevealViewController">SWRevealViewController</a><blockquote>
<p>A UIViewController subclass for revealing a rear (left and&#x2F;or right) view controller behind a front controller, inspired by the Facebook app, done right!</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/erichoracek/MSDynamicsDrawerViewController">MSDynamicsDrawerViewController</a><blockquote>
<p>Container view controller that leverages UIKit Dynamics to provide a realistic drawer navigation paradigm.</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/pkluz/PKRevealController">PKRevealController</a><blockquote>
<p>安装简便，高度定制且对手势识别良好</p>
</blockquote>
</li>
</ul>
<h3 id="NavigationBar"><a href="#NavigationBar" class="headerlink" title="NavigationBar"></a>NavigationBar</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/andreamazz/AMScrollingNavbar">AMScrollingNavbar</a><blockquote>
<p><code>Swift</code> 语言编写上下滑动时动态隐藏标题栏</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ltebean/LTNavigationbar">LTNavigationbar</a><blockquote>
<p>导航栏颜色动态改变</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/JazysYu/JZNavigationExtension">JZNavigationExtension</a><blockquote>
<p>Navigation 的扩展，推荐</p>
</blockquote>
</li>
</ul>
<h3 id="ScrollView-相关"><a href="#ScrollView-相关" class="headerlink" title="ScrollView 相关"></a>ScrollView 相关</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/nicklockwood/SwipeView">SwipeView</a><blockquote>
<p>SwipeView is a class designed to simplify the implementation of horizontal, paged scrolling views on iOS. It is based on a UIScrollView, but adds convenient functionality such as a UITableView-style dataSource&#x2F;delegate interface for loading views dynamically, and efficient view loading, unloading and recycling.</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/CEWendel/SWTableViewCell">SWTableViewCell</a><blockquote>
<p>自定义 Cell 侧滑动作</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/MortimerGoro/MGSwipeTableCell">MGSwipeTableCell</a><blockquote>
<p>自定义 Cell 侧滑动作，效果多样</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/chiahsien/CHTCollectionViewWaterfallLayout">CHTCollectionViewWaterfallLayout</a><blockquote>
<p>瀑布流布局</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/12207480/TYSlidePageScrollView">TYSlidePageScrollView</a><blockquote>
<p>An easy solution to page views or controllers with header and page tabbar,footer</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/wangruofeng/XLPagerTabStrip">XLPagerTabStrip</a><blockquote>
<p>Android PagerTabStrip for iOS. nice</p>
</blockquote>
</li>
</ul>
<h3 id="MJ-系列"><a href="#MJ-系列" class="headerlink" title="MJ 系列"></a>MJ 系列</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/CoderMJLee/MJExtension">MJExtension</a><blockquote>
<p>model &lt;–&gt; dic &lt;–&gt; json 框架</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/CoderMJLee/MJRefresh">MJRefresh</a><blockquote>
<p>刷新控件</p>
</blockquote>
</li>
</ul>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/realm/realm-cocoa">realm-cocoa</a><blockquote>
<p>跨平台轻量级数据库解决方案,励志取代 <code>Core Data</code> &amp; <code>SQLite</code> * <a target="_blank" rel="noopener" href="https://github.com/ccgus/fmdb">fmdb</a><br>对 <code>sqlite</code> 实现面向对象的封装</p>
</blockquote>
</li>
</ul>
<h3 id="图标库"><a href="#图标库" class="headerlink" title="图标库"></a>图标库</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/kevinzhow/PNChart">PNChart</a><blockquote>
<p>提供各种图标样式，性能还非常不错</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/danielgindi/Charts">Charts</a><blockquote>
<p>Beautiful charts for iOS&#x2F;tvOS&#x2F;OSX! The Apple side of the crossplatform MPAndroidChart.</p>
</blockquote>
</li>
</ul>
<h3 id="图片处理以及展示相关"><a href="#图片处理以及展示相关" class="headerlink" title="图片处理以及展示相关"></a>图片处理以及展示相关</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/BradLarson/GPUImage">GPUImage</a><blockquote>
<p>开源基于 GPU 的图片渲染引擎，带有很多款滤镜</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="http://github.com/nicklockwood/FXBlurView">FXBlurView</a><blockquote>
<p>背景模糊</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ideaismobile/IDMPhotoBrowser">IDMPhotoBrowser</a><blockquote>
<p>照片浏览器</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/arturgrigor/AGImagePickerController">AGImagePickerController</a><blockquote>
<p>相册选择</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/AwesomeDennis/DNImagePicker">DNImagePicker</a><blockquote>
<p>仿照微信的照片选取器</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/johnil/JFImagePickerController">JFImagePickerController</a><blockquote>
<p>又一个照片选取器</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/kean/Nuke">Nuke</a><blockquote>
<p>Image loading, processing, caching and preheating</p>
</blockquote>
</li>
</ul>
<h3 id="日历选择"><a href="#日历选择" class="headerlink" title="日历选择"></a>日历选择</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/WenchaoD/FSCalendar">FSCalendar</a><blockquote>
<p>iOS7+风格的日历控件，非常漂亮</p>
</blockquote>
</li>
</ul>
<h3 id="音频-视频"><a href="#音频-视频" class="headerlink" title="音频&#x2F;视频"></a>音频&#x2F;视频</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/36Kr-Mobile/KRVideoPlayer">KRVideoPlayer</a><blockquote>
<p>36 氪开源的视频播放器</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/douban/DOUAudioStreamer">DOUAudioStreamer</a><blockquote>
<p>豆瓣开源的音频播放器</p>
</blockquote>
</li>
</ul>
<h3 id="内购-推广"><a href="#内购-推广" class="headerlink" title="内购&#x2F;推广"></a>内购&#x2F;推广</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/saturngod/IAPHelper">IAPHelper</a><blockquote>
<p>in app purchases helper for iOS</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/danielamitay/DAAppsViewController">DAAppsViewController</a><blockquote>
<p>应用推广界面，填写合作 app 的 appleId 即可</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/JanC/TAPromotee.git">TAPromotee</a><blockquote>
<p>交叉推广应用是你可以免费实现的最佳市场推广策略之一。</p>
</blockquote>
</li>
</ul>
<h3 id="存储相关"><a href="#存储相关" class="headerlink" title="存储相关"></a>存储相关</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/soffes/sskeychain">SSKeychain</a><blockquote>
<p>钥匙串存储</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/wangruofeng/PINCache">PINCache</a><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/pinterest">Pinterest</a>出品的非阻塞式异步缓存工具</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/tumblr/TMCache">TMCache</a><blockquote>
<p><a target="_blank" rel="noopener" href="https://github.com/tumblr">tumblr</a>出品的对象快速异步缓存，支持 <code>iOS</code> 和 <code>OS X</code> * <a target="_blank" rel="noopener" href="https://github.com/magicalpanda/MagicalRecord">MagicalRecord</a><br>简化 <code>Core Data</code> 抓取数据的逻辑，推荐</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/kishikawakatsumi/KeychainAccess">KeychainAccess</a><blockquote>
<p>Simple Swift wrapper for Keychain that works on iOS and OS X</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/kishikawakatsumi/UICKeyChainStore">UICKeyChainStore</a> <blockquote>
<p><code>UICKeyChainStore</code> 的简单封装</p>
</blockquote>
</li>
</ul>
<h3 id="实用控件"><a href="#实用控件" class="headerlink" title="实用控件"></a>实用控件</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/hsousa/HCSStarRatingView">HCSStarRatingView</a><blockquote>
<p>简单的评分控件</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/LeoNatan/LNNotificationsUI">LNNotificationsUI</a><blockquote>
<p>模仿 iOS 标准通知界面，可以以假乱真</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/vikmeup/SCLAlertView-Swift">SCLAlertView-Swift</a><blockquote>
<p>非常漂亮的动画 <code>Alert View</code> ，使用 <code>Swift</code> 书写</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/dsxNiubility/Wonderful">Wonderful</a> <blockquote>
<p>跑马灯,彩色标签,渐变等…</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/johnil/VVeboTableViewDemo">VVeboTableViewDemo</a> <blockquote>
<p>VVebo 剥离的 TableView 绘制</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/nicklockwood/FXForms">FXForms</a><blockquote>
<p>快速创建表单,设置页,用户数据任务,非常棒</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/samvermette/SVPullToRefresh">SVPullToRefresh</a><blockquote>
<p>一行代码实现 UIScrollView 下拉刷新或者无限滚动</p>
</blockquote>
</li>
</ul>
<h3 id="辅助类"><a href="#辅助类" class="headerlink" title="辅助类"></a>辅助类</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/mattt/Surge">Surge</a><blockquote>
<p>利用 <code>Accelerate</code> 高性能数学计算框架</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/kconner/KMCGeigerCounter">KMCGeigerCounter</a><blockquote>
<p>显示当前动画的帧率</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/xing/XNGMarkdownParser">XNGMarkdownParser</a><blockquote>
<p><code>Markdown</code> 解析器，将 <code>Markdown</code> 格式的字符串解析成 <code>NSAttributedString</code> 格式的字符串</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/mattt/TransformerKit">TransformerKit</a><blockquote>
<p>封装了一些常用的 <code>NSValueTransformer</code> 类</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/nst/RuntimeBrowser">RuntimeBrowser</a><blockquote>
<p>Objective-C Runtime Browser, for Mac OS X and iOS</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/nst/iOS-Runtime-Headers">iOS-Runtime-Headers</a> <blockquote>
<p>iOS Objective-C headers as derived from runtime introspection</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/tomaz/appledoc">appledoc</a><blockquote>
<p>Objective-C 代码，苹果风格文档生成器</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/kristopherjohnson/Markingbird">Markingbird</a><blockquote>
<p>Markdown processor written in Swift (translation of MarkdownSharp)</p>
</blockquote>
</li>
</ul>
<p>	</p>
<h3 id="Swift"><a href="#Swift" class="headerlink" title="Swift"></a>Swift</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/allenwong/30DaysofSwift">30DaysofSwift</a><blockquote>
<p>allenwong 自学 Swift 的 30 个工程 👍</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ipader/SwiftGuide">SwiftGuide</a><blockquote>
<p>这份指南汇集了 Swift 语言主流学习资源，并以开发者的视角整理编排</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/apple/swift-package-manager">swift-package-manager</a><blockquote>
<p>Swift 包管理工具</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/Carthage/Carthage">Carthage</a><blockquote>
<p>Swift 依赖管理工具，类似 OC 的 <code>CocoaPods</code> * <a target="_blank" rel="noopener" href="https://github.com/raywenderlich/swift-style-guide">swift-style-guide</a><br><a target="_blank" rel="noopener" href="https://github.com/raywenderlich">raywenderlich.com</a>官方 Swift 编程风格规</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ReactiveX/RxSwift">RxSwift</a><blockquote>
<p>Reactive Programming in Swift</p>
</blockquote>
</li>
</ul>
<h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/FreeCodeCamp/FreeCodeCamp">FreeCodeCamp</a><blockquote>
<p>The <a target="_blank" rel="noopener" href="https://freecodecamp.com/">https://FreeCodeCamp.com</a> open source codebase and curriculum. Learn to code and help nonprofits. </p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/jspahrsummers/libextobjc">libextobjc</a><blockquote>
<p>拓展了一些 <code>Cocoa</code> 类库</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/ChenYilong/ParseSourceCodeStudy">ParseSourceCodeStudy</a><blockquote>
<p>Facebook 开源的 Parse 源码分析【系列】</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/spf13/hugo">hugo</a><blockquote>
<p>使用 <code>Google</code> <code>Go</code> 语言书写的静态博客网站生成器</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/CocoaPods/CocoaPods">CocoaPods</a><blockquote>
<p>Cocoa 包依赖管理工具</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/wangruofeng/MDCSwipeToChoose">MDCSwipeToChoose</a><blockquote>
<p>实现某 App，左滑不喜欢，右滑喜欢的卡片堆叠功能</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/omz/Dash-Plugin-for-Xcode">Dash-Plugin-for-Xcode</a><blockquote>
<p><code>Xcode</code> 的一个插件，整合 <code>Dash</code> ，方便快速查阅文档</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/lzyy/iOS-Developer-Interview-Questions">iOS 开发面试问题</a><blockquote>
<p>汇总一些常见的 iOS 面试问题</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/robbiehanson/XMPPFramework">XMPPFramework</a><blockquote>
<p><code>XMPP</code> 即时通信协议框架	</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/marcuswestin/WebViewJavascriptBridge">WebViewJavascriptBridge</a><blockquote>
<p><code>Objective-C</code> 与 <code>JavaScript</code> 在 <code>UIWebViews</code> &#x2F; <code>WKWebView</code> 之间交互解决方案</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/objccn/articles">articles-1</a><blockquote>
<p>Articles for objccn.io. objc.io 的完整、准确、优雅的中文翻译版本</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/NSHipster/articles">articles</a><blockquote>
<p>Weekly articles for NSHipster.com</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/onestraw/ebook">ebook</a>	<blockquote>
<p>收集了一些 coding 相关的电子书</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/nixzhu/dev-blog">dev-blog</a><blockquote>
<p>nixzhu 的一些 iOS &#x2F; Web 开发相关的翻译或原创博客文章</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/facebook/KVOController">KVOController</a><blockquote>
<p>Simple, modern, thread-safe key-value observing for iOS and OS X.</p>
</blockquote>
</li>
<li><a target="_blank" rel="noopener" href="https://github.com/MxABC/LBXScan">LBXScan</a><blockquote>
<p>二维码、扫码、扫一扫、ZXing 和 ios 系统自带扫码封装，扫码界面效果封装</p>
</blockquote>
</li>
</ul>
<p>参考链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://blog.treney.com/index.php/archives/iOSShare.html">iOS 学习资源汇总</a> – 鹏威の博客博客</li>
</ul>
<!-- processed 2 -->

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



                        </div>
                        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

                    </div>
                        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">王若风</p>
  <div class="site-description" itemprop="description">王若风的技术博客</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">79</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/wangruofeng" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;wangruofeng" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:wangruofeng007@gmail.com" title="E-Mail → mailto:wangruofeng007@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/oneruofeng" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;oneruofeng" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://instagram.com/ace_freeman007" title="Instagram → https:&#x2F;&#x2F;instagram.com&#x2F;ace_freeman007" rel="noopener" target="_blank"><i class="fab fa-instagram fa-fw"></i>Instagram</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


                </div>
            </main>

            <footer class="footer">
                <div class="footer-inner">
                    

                    

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">王若风</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">118k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">7:09</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

                    








                </div>
            </footer>
        </div>

        
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




        
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>














        
            <script
                type="text/javascript"
                src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
        
            

            

<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://wangruofeng007.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>

    </body>
</html>